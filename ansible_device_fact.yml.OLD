---
  - name: Gather facts
    hosts: localhost
    gather_facts: true
    vars:
     abc: test
    tasks:
   
    #- set_fact:
    #    device_info: "device_info: {{ item }}" 
    #  with_items: "{{ ansible_devices }}"
    #  when: "ansible_devices.startwith('sd')"

    - set_fact:
        abc: ""
    - debug: 
        #msg: "{{ device_info |select('match', '(sd)[a-z]+') |list}}"
        #msg: "Device: {{ item.key }} {{ item.value }}"
        msg: "{{ abc }}"
      #with_items: "{{ ansible_devices|dict2items }}" 
      #with_items: "{{ ansible_devices|dict2items|list }}" 
      #with_items: "{{ ansible_devices| dict2items|map(attribute='key', 'sda')|list }}" 
      #with_items: "{{ ansible_devices| dict2items|map(attribute='key') | list }}"
      #when: "ansible_devices.keys().startswith()"
      
    - pause:
    - name: get device name
      set_fact:
        device_name: "{{ item.key }}"
      no_log: True
      with_dict: "{{ ansible_devices }}"
      when: "item.value.host.startswith('Serial')"

    - name: show all values for selected device name
      debug: var=ansible_devices[device_name]

    - name: show only device name
      debug: 
        msg: "{{ item }}"
      with_items: "{{ device_name }}"
